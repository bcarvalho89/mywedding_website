/*!
 * mywedding_website
 * My Wedding Website
 * http://brukel.cf
 * @author Bruno Carvalho
 * @version 1.0.0
 * Copyright 2016. MIT licensed.
 */
!function(e,s,a,t){"use strict";e(function(){function t(e,s,a){var t=e.substring(6),n=e.substring(0,2),o=e.substring(3,5),i=new Date(t,o-1,n),d=new Date,l="",c=Date.dateDiff("d",i,d);0===c&&a.html("É hoje!"),c>0&&(l=c,a.html("Estamos casados há "+l+" dias")),1===c&&(l=c,a.html("Estamos casados há "+l+" dia")),0>c&&(l=Math.abs(c),a.html("Faltam "+l+" dias")),-1===c&&(l=Math.abs(c),a.html("É amanhã!"))}var n=e("#messages"),o="inc/guestbook/message.php",i=n.data("page"),d=e(s).height(),l=75,c=e(".menu"),r=e("header"),m=e(".countdown-text"),u=e("#load-more"),p=e(".to-top");Date.dateDiff=function(e,s,a){e=e.toLowerCase();var t=a-s,n={w:6048e5,d:864e5,h:36e5,n:6e4,s:1e3};return Math.floor(t/n[e])},e(a).ready(function(){t("28/08/2016","11:00h",m),p.click(function(s){s.preventDefault(),e("body,html").animate({scrollTop:0},400)}),c.on("click","a",function(s){s.preventDefault();var a=e("#"+e(this).data("section"));e("html, body").stop().animate({scrollTop:a.offset().top-l},500,"swing",function(){})}),e("#guestbook_form").submit(function(s){s.preventDefault();var t=e(this).find("#guestName").val(),i=e(this).find("#guestMessage").val(),d=this,l=e(d).find(".response");e.ajax({url:o,type:"POST",dataType:"json",data:{name:t,message:i,insert:!0}}).done(function(e){if(console.log(e),l.html(""),e.success){var s=e.data,t='<div class="message"><div class="message-wrap"><p>'+s.message+"</p></div><h2>"+s.name+"</h2><span>"+s.dateTime+"</span></div>",o=a.createElement("div"),i=a.querySelector("#messages");salvattore.append_elements(i,[o]),o.outerHTML=t,n.removeClass("no-messages").find(".no-message").remove(),u.fadeIn(),d.reset()}else{for(var c="",r=0;r<e.msg.length;r++)c+="<span>"+e.msg[r]+"</span>";l.html(c)}}).fail(function(e){console.log(e)}).always(function(){})}),e.getJSON(o,{select:!0,page:i},function(s){if(s.success){var t=s.data;e.each(t,function(e,s){var t='<div class="message"><div class="message-wrap"><p>'+s.message+"</p></div><h2>"+s.name+"</h2><span>"+s.dateTime+"</span></div>",n=a.createElement("div"),o=a.querySelector("#messages");salvattore.append_elements(o,[n]),n.outerHTML=t}),setTimeout(function(){},10)}else u.hide(),n.addClass("no-messages").append('<div class="no-message"><p>Não recebemos nenhuma mensagem. Que tal ser o primeiro?</p></div>')}),u.click(function(){var s=n.data("page"),t=e(this);t.find("i").toggleClass("icon-plus icon-spinner"),e.getJSON(o,{select:!0,page:s+1},function(o){if(o.success){var i=o.data;e.each(i,function(e,s){var t='<div class="message"><div class="message-wrap"><p>'+s.message+"</p></div><h2>"+s.name+"</h2><span>"+s.dateTime+"</span></div>",n=a.createElement("div"),o=a.querySelector("#messages");salvattore.append_elements(o,[n]),n.outerHTML=t}),n.data("page",s+1),t.find("i").toggleClass("icon-spinner icon-plus")}else setTimeout(function(){t.find("i").remove(),t.addClass("disabled"),t.attr("disabled","disabled")},200)})})}),e(s).resize(function(){}),e(s).load(function(){setTimeout(function(){e("body").addClass("loaded")},1e3)}),e(s).scroll(function(){var a=s.scrollY,t=e(this).scrollTop(),n=15*a/e(s).height();e("#intro .cover").css({"background-position-y":100-n+"%"}),t>d-6*l?(r.addClass("pinned"),p.addClass("show")):(r.removeClass("pinned"),p.removeClass("show")),e(".menu a").each(function(){var s=e(this),a=e("#"+s.data("section"));a.position().top-2*l<=t&&a.position().top+a.height()>t?(e(".menu a").removeClass("active"),s.addClass("active")):s.removeClass("active")})})})}(jQuery,window,document);