/*!
 * mywedding_website
 * My Wedding Website
 * http://brukel.cf
 * @author Bruno Carvalho
 * @version 1.0.0
 * Copyright 2016. MIT licensed.
 */
!function(e,a,s,t){"use strict";e(function(){function t(e,a,s){var t=e.substring(6),n=e.substring(0,2),o=e.substring(3,5),i=new Date(t,o-1,n),l=new Date,r="",d=Date.dateDiff("d",i,l);0===d&&s.html("É hoje!"),d>0&&(r=d,s.html("Estamos casados há "+r+" dias")),1===d&&(r=d,s.html("Estamos casados há "+r+" dia")),0>d&&(r=Math.abs(d),s.html("Faltam "+r+" dias")),-1===d&&(r=Math.abs(d),s.html("É amanhã!"))}function n(){var e=[{stylers:[{hue:"#29aba7"},{saturation:0}]},{featureType:"road",elementType:"geometry",stylers:[{lightness:100},{visibility:"simplified"}]}],a=new google.maps.StyledMapType(e,{name:"Espaço Monterrey"}),t="assets/img/marker.png",n=new google.maps.LatLng(-23.0624768,-46.8706222),o={zoom:15,center:n,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,"map_style"]}},i=new google.maps.Map(s.getElementById("mapa"),o);new google.maps.Marker({position:n,map:i,icon:t});i.mapTypes.set("map_style",a),i.setMapTypeId("map_style")}var o=e("#messages"),i="inc/guestbook/message.php",l=o.data("page"),r=e(a).height(),d=75,m=e(".menu"),p=e("header"),c=e(".countdown-text"),u=e("#load-more"),f=e(".to-top");Date.dateDiff=function(e,a,s){e=e.toLowerCase();var t=s-a,n={w:6048e5,d:864e5,h:36e5,n:6e4,s:1e3};return Math.floor(t/n[e])},google.maps.event.addDomListener(a,"load",n),e(s).ready(function(){t("28/08/2016","11:00h",c),e("#form_rsvp").on("change",".child",function(){var a=e(this);a.prop("checked")?a.after('<label>Idade</label><input class="age" type="text" />'):(a.next().remove(),a.next().remove())}),e("#more-people").click(function(a){a.preventDefault();var s=e("#form_rsvp .form-group"),t=s.last(),n=(s.length,'<div class="form-group"><label>Nome</label><input class="name" type="text" placeholder="Digite o nome completo" /><label>É criança?</label><input class="child" type="checkbox" name="child" /><button class="btn remove"><i class="icon-user-remove"></i></button></div>');t.after(n)}),e("#form_rsvp").on("click",".remove",function(){e(this).parent().remove()}),e("#form_rsvp .confirmation .btn").click(function(a){a.preventDefault();var s=e(this).data("confirmation"),t={},n=[],o=[],i=e("#form_rsvp .response"),l=e("#form_rsvp .form-group"),r=!1;l.each(function(a,s){var l=e.trim(e(s).find(".name").val()),d=0,m=null;if(l.length<10&&(o.push("Digite o nome completo"),r=!0),e(s).find(".child").prop("checked")&&(d=1,m=e.trim(e(s).find(".age").val()),m=parseInt(m),(m>14||isNaN(m))&&(o.push("Digite a idade corretamente"),r=!0)),r){for(var p="",c=0;c<o.length;c++)p+="<span>"+o[c]+"</span>";i.html(p)}else i.html(""),t={name:l,child:d,age:m},n.push(t)}),r||e.ajax({url:"inc/send_mail.php",type:"POST",dataType:"json",beforeSend:function(){e("#form_rsvp").find(".btn").addClass("disabled").attr("disabled","disabled"),e("#form_rsvp").find("input").addClass("disabled").attr("disabled","disabled"),i.html('<i class="icon-spinner"></i>')},data:{people:n,confirmation:s}}).done(function(a){a.success||(e("#form_rsvp").find(".btn").removeClass("disabled").removeAttr("disabled"),e("#form_rsvp").find("input").removeClass("disabled").removeAttr("disabled")),i.html("<span>"+a.msg+"</span>")}).fail(function(a){e("#form_rsvp").find(".btn").removeClass("disabled").removeAttr("disabled"),e("#form_rsvp").find("input").removeClass("disabled").removeAttr("disabled")}).always(function(){})}),f.click(function(a){a.preventDefault(),e("body,html").animate({scrollTop:0},400)}),m.on("click","a",function(a){a.preventDefault();var s=e("#"+e(this).data("section"));e("html, body").stop().animate({scrollTop:s.offset().top-d},500,"swing",function(){})}),e("#guestbook_form").submit(function(a){a.preventDefault();var t=e(this).find("#guestName").val(),n=e(this).find("#guestMessage").val(),l=this,r=e(l).find(".response");e.ajax({url:i,type:"POST",dataType:"json",data:{name:t,message:n,insert:!0}}).done(function(e){if(console.log(e),r.html(""),e.success){var a=e.data,t='<div class="message"><div class="message-wrap"><p>'+a.message+"</p></div><h2>"+a.name+"</h2><span>"+a.dateTime+"</span></div>",n=s.createElement("div"),i=s.querySelector("#messages");salvattore.append_elements(i,[n]),n.outerHTML=t,o.removeClass("no-messages").find(".no-message").remove(),u.fadeIn(),l.reset()}else{for(var d="",m=0;m<e.msg.length;m++)d+="<span>"+e.msg[m]+"</span>";r.html(d)}}).fail(function(e){console.log(e)}).always(function(){})}),e.getJSON(i,{select:!0,page:l},function(a){if(a.success){var t=a.data;e.each(t,function(e,a){var t='<div class="message"><div class="message-wrap"><p>'+a.message+"</p></div><h2>"+a.name+"</h2><span>"+a.dateTime+"</span></div>",n=s.createElement("div"),o=s.querySelector("#messages");salvattore.append_elements(o,[n]),n.outerHTML=t}),setTimeout(function(){},10)}else u.hide(),o.addClass("no-messages").append('<div class="no-message"><p>Não recebemos nenhuma mensagem. Que tal ser o primeiro?</p></div>')}),u.click(function(){var a=o.data("page"),t=e(this);t.find("i").toggleClass("icon-plus icon-spinner"),e.getJSON(i,{select:!0,page:a+1},function(n){if(n.success){var i=n.data;e.each(i,function(e,a){var t='<div class="message"><div class="message-wrap"><p>'+a.message+"</p></div><h2>"+a.name+"</h2><span>"+a.dateTime+"</span></div>",n=s.createElement("div"),o=s.querySelector("#messages");salvattore.append_elements(o,[n]),n.outerHTML=t}),o.data("page",a+1),t.find("i").toggleClass("icon-spinner icon-plus")}else setTimeout(function(){t.find("i").remove(),t.addClass("disabled"),t.attr("disabled","disabled")},200)})})}),e(a).resize(function(){}),e(a).load(function(){setTimeout(function(){e("body").addClass("loaded"),e(".gallery").masonry({itemSelector:".image",columnWidth:".image",percentPosition:!0}),e(".gallery").lightGallery({thumbnail:!0,thumbMargin:2,currentPagerPosition:"middle",download:!1,counter:!1,animateThumb:!1,showThumbByDefault:!1})},1e3)}),e(a).scroll(function(){var s=a.scrollY,t=e(this).scrollTop(),n=15*s/e(a).height();e("#intro .cover").css({"background-position-y":100-n+"%"}),t>r-6*d?(p.addClass("pinned"),f.addClass("show")):(p.removeClass("pinned"),f.removeClass("show")),e(".menu a").each(function(){var a=e(this),s=e("#"+a.data("section"));s.position().top-2*d<=t&&s.position().top+s.height()>t?(e(".menu a").removeClass("active"),a.addClass("active")):a.removeClass("active")})})})}(jQuery,window,document);