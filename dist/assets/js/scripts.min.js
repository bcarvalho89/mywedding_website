/*!
 * mywedding_website
 * My Wedding Website
 * http://brukel.cf
 * @author Bruno Carvalho
 * @version 1.0.0
 * Copyright 2016. MIT licensed.
 */
!function(e,a,s,t){"use strict";e(function(){var t=e("#messages"),n="inc/guestbook/message.php",i=t.data("page"),o=e(a).height(),c=75,d=e(".menu"),l=e("header"),p=e(".to-top");e(s).ready(function(){p.click(function(a){a.preventDefault(),e("body,html").animate({scrollTop:0},400)}),d.on("click","a",function(a){a.preventDefault(),d.find(".active").removeClass("active"),e(this).addClass("active");var s=e("#"+e(this).data("section"));e("html, body").stop().animate({scrollTop:s.offset().top-c},500,"swing",function(){})}),e("#guestbook").submit(function(a){a.preventDefault();var s=e(this).find("#guestName").val(),i=e(this).find("#guestMessage").val(),o=this;e.ajax({url:n,type:"POST",dataType:"json",data:{name:s,message:i,insert:!0}}).done(function(e){if(console.log(e),e.success){var a=e.data,s='<div class="message"><p>'+a.message+"</p><h2>"+a.name+"</h2><span>"+a.dateTime+"</span></div>";t.prepend(s),o.reset()}}).fail(function(e){console.log(e)}).always(function(){})}),e.getJSON(n,{select:!0,page:i},function(e){if(e.success)for(var a=e.data,s=0;s<a.length;s++){var n='<div class="message"><p>'+a[s].message+"</p><h2>"+a[s].name+"</h2><span>"+a[s].dateTime+"</span></div>";t.append(n)}else t.append("Sem mensagens")}),e("#load-more").click(function(){var a=t.data("page"),s=e(this);e.getJSON(n,{select:!0,page:a+1},function(e){if(e.success){for(var n=e.data,i=0;i<n.length;i++){var o='<div class="message"><p>'+n[i].message+"</p><h2>"+n[i].name+"</h2><span>"+n[i].dateTime+"</span></div>";t.append(o)}t.data("page",a+1)}else s.attr("disabled","disabled")})})}),e(a).resize(function(){}),e(a).scroll(function(){var s=a.scrollY,t=e(this).scrollTop(),n=15*s/e(a).height();e(".intro .cover").css({"background-position-y":100-n+"%"}),t>o-6*c?(l.addClass("pinned"),p.addClass("show")):(l.removeClass("pinned"),p.removeClass("show")),e(".menu a").each(function(){var a=e(this),s=e("#"+a.data("section"));s.position().top-c<=t&&s.position().top+s.height()>t?(e(".menu a").removeClass("active"),a.addClass("active")):a.removeClass("active")})})})}(jQuery,window,document);