/*!
 * mywedding_website
 * My Wedding Website
 * http://brukel.cf
 * @author Bruno Carvalho
 * @version 1.0.0
 * Copyright 2016. MIT licensed.
 */
!function(e,a,s,t){"use strict";e(function(){function t(e,a,s){var t=e.substring(6),n=e.substring(0,2),o=e.substring(3,5),i=new Date(t,o-1,n),l=new Date,r="",m=Date.dateDiff("d",i,l);0===m&&s.html("É hoje!"),m>0&&(r=m,s.html("Estamos casados há "+r+" dias")),1===m&&(r=m,s.html("Estamos casados há "+r+" dia")),0>m&&(r=Math.abs(m),s.html("Faltam "+r+" dias")),-1===m&&(r=Math.abs(m),s.html("É amanhã!"))}function n(){var e=[{stylers:[{hue:"#29aba7"},{saturation:0}]},{featureType:"road",elementType:"geometry",stylers:[{lightness:100},{visibility:"simplified"}]}],a=new google.maps.StyledMapType(e,{name:"Espaço Monterrey"}),t="assets/img/marker.png",n=new google.maps.LatLng(-23.0624768,-46.8706222),o={zoom:15,center:n,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,"map_style"]}},i=new google.maps.Map(s.getElementById("mapa"),o);new google.maps.Marker({position:n,map:i,icon:t});i.mapTypes.set("map_style",a),i.setMapTypeId("map_style")}var o=e("#messages"),i="inc/guestbook/message.php",l=o.data("page"),r=e(a).height(),m=75,c=e(".menu"),p=e("header"),d=e(".countdown-text"),u=e("#load-more"),g=e(".to-top");Date.dateDiff=function(e,a,s){e=e.toLowerCase();var t=s-a,n={w:6048e5,d:864e5,h:36e5,n:6e4,s:1e3};return Math.floor(t/n[e])},google.maps.event.addDomListener(a,"load",n),e(s).ready(function(){t("28/08/2016","11:00h",d),e("#form_rsvp").on("change",".child",function(){var a=e(this);a.prop("checked")?a.after('<label>Idade</label><input class="age" type="text" />'):(a.next().remove(),a.next().remove())}),e("#more-people").click(function(a){a.preventDefault();var s=e("#form_rsvp .form-group"),t=s.last(),n=s.length,o='<div class="form-group"><label>Pessoa '+(n+1)+'</label><input class="name" type="text" placeholder="Digite o nome completo" /><label>É criança?</label><input class="child" type="checkbox" name="child" /><button class="btn remove"><i class="icon-user-remove"></i></button></div>';t.after(o)}),e("#form_rsvp").on("click",".remove",function(){e(this).parent().remove()}),e("#form_rsvp .confirmation").click(function(a){a.preventDefault();var s={},t=[],n=[],o=e("#form_rsvp .response"),i=e("#form_rsvp .form-group");i.each(function(a,i){var l=e.trim(e(i).find(".name").val()),r=!1,m=null,c=!1;if(l.length<10&&(n.push("Digite o nome completo"),c=!0),e(i).find(".child").prop("checked")&&(r=!0,m=e.trim(e(i).find(".age").val()),m=parseInt(m),(m>14||isNaN(m))&&(n.push("Digite a idade corretamente"),c=!0)),c){for(var p="",d=0;d<n.length;d++)p+="<span>"+n[d]+"</span>";o.html(p)}else o.html(""),s={name:l,child:r,age:m},t.push(s)}),console.log(t)}),g.click(function(a){a.preventDefault(),e("body,html").animate({scrollTop:0},400)}),c.on("click","a",function(a){a.preventDefault();var s=e("#"+e(this).data("section"));e("html, body").stop().animate({scrollTop:s.offset().top-m},500,"swing",function(){})}),e("#guestbook_form").submit(function(a){a.preventDefault();var t=e(this).find("#guestName").val(),n=e(this).find("#guestMessage").val(),l=this,r=e(l).find(".response");e.ajax({url:i,type:"POST",dataType:"json",data:{name:t,message:n,insert:!0}}).done(function(e){if(console.log(e),r.html(""),e.success){var a=e.data,t='<div class="message"><div class="message-wrap"><p>'+a.message+"</p></div><h2>"+a.name+"</h2><span>"+a.dateTime+"</span></div>",n=s.createElement("div"),i=s.querySelector("#messages");salvattore.append_elements(i,[n]),n.outerHTML=t,o.removeClass("no-messages").find(".no-message").remove(),u.fadeIn(),l.reset()}else{for(var m="",c=0;c<e.msg.length;c++)m+="<span>"+e.msg[c]+"</span>";r.html(m)}}).fail(function(e){console.log(e)}).always(function(){})}),e.getJSON(i,{select:!0,page:l},function(a){if(a.success){var t=a.data;e.each(t,function(e,a){var t='<div class="message"><div class="message-wrap"><p>'+a.message+"</p></div><h2>"+a.name+"</h2><span>"+a.dateTime+"</span></div>",n=s.createElement("div"),o=s.querySelector("#messages");salvattore.append_elements(o,[n]),n.outerHTML=t}),setTimeout(function(){},10)}else u.hide(),o.addClass("no-messages").append('<div class="no-message"><p>Não recebemos nenhuma mensagem. Que tal ser o primeiro?</p></div>')}),u.click(function(){var a=o.data("page"),t=e(this);t.find("i").toggleClass("icon-plus icon-spinner"),e.getJSON(i,{select:!0,page:a+1},function(n){if(n.success){var i=n.data;e.each(i,function(e,a){var t='<div class="message"><div class="message-wrap"><p>'+a.message+"</p></div><h2>"+a.name+"</h2><span>"+a.dateTime+"</span></div>",n=s.createElement("div"),o=s.querySelector("#messages");salvattore.append_elements(o,[n]),n.outerHTML=t}),o.data("page",a+1),t.find("i").toggleClass("icon-spinner icon-plus")}else setTimeout(function(){t.find("i").remove(),t.addClass("disabled"),t.attr("disabled","disabled")},200)})})}),e(a).resize(function(){}),e(a).load(function(){setTimeout(function(){e("body").addClass("loaded"),e(".gallery").masonry({itemSelector:".image",columnWidth:".image",percentPosition:!0}),e(".gallery").lightGallery({thumbnail:!0,thumbMargin:2,currentPagerPosition:"middle",download:!1,counter:!1,animateThumb:!1,showThumbByDefault:!1})},1e3)}),e(a).scroll(function(){var s=a.scrollY,t=e(this).scrollTop(),n=15*s/e(a).height();e("#intro .cover").css({"background-position-y":100-n+"%"}),t>r-6*m?(p.addClass("pinned"),g.addClass("show")):(p.removeClass("pinned"),g.removeClass("show")),e(".menu a").each(function(){var a=e(this),s=e("#"+a.data("section"));s.position().top-2*m<=t&&s.position().top+s.height()>t?(e(".menu a").removeClass("active"),a.addClass("active")):a.removeClass("active")})})})}(jQuery,window,document);