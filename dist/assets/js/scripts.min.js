/*!
 * mywedding_website
 * My Wedding Website
 * http://brukel.cf
 * @author Bruno Carvalho
 * @version 1.0.0
 * Copyright 2016. MIT licensed.
 */
!function(e,a,s,t){"use strict";e(function(){function t(e,a,s){var t=e.substring(6),n=e.substring(0,2),o=e.substring(3,5),i=new Date(t,o-1,n),c=new Date,d="",l=Date.dateDiff("d",i,c);0===l&&s.html("É hoje!"),l>0&&(d=l,s.html("Estamos casados há "+d+" dias")),1===l&&(d=l,s.html("Estamos casados há "+d+" dia")),0>l&&(d=Math.abs(l),s.html("Faltam "+d+" dias")),-1===l&&(d=Math.abs(l),s.html("É amanhã!"))}var n=e("#messages"),o="inc/guestbook/message.php",i=n.data("page"),c=e(a).height(),d=75,l=e(".menu"),r=e("header"),p=e(".countdown-text"),h=e(".to-top");Date.dateDiff=function(e,a,s){e=e.toLowerCase();var t=s-a,n={w:6048e5,d:864e5,h:36e5,n:6e4,s:1e3};return Math.floor(t/n[e])},e(s).ready(function(){t("28/08/2016","11:00h",p),h.click(function(a){a.preventDefault(),e("body,html").animate({scrollTop:0},400)}),l.on("click","a",function(a){a.preventDefault();var s=e("#"+e(this).data("section"));e("html, body").stop().animate({scrollTop:s.offset().top-d},500,"swing",function(){})}),e("#guestbook").submit(function(a){a.preventDefault();var s=e(this).find("#guestName").val(),t=e(this).find("#guestMessage").val(),i=this;e.ajax({url:o,type:"POST",dataType:"json",data:{name:s,message:t,insert:!0}}).done(function(e){if(console.log(e),e.success){var a=e.data,s='<div class="message"><p>'+a.message+"</p><h2>"+a.name+"</h2><span>"+a.dateTime+"</span></div>";n.prepend(s),i.reset()}}).fail(function(e){console.log(e)}).always(function(){})}),e.getJSON(o,{select:!0,page:i},function(e){if(e.success)for(var a=e.data,s=0;s<a.length;s++){var t='<div class="message"><p>'+a[s].message+"</p><h2>"+a[s].name+"</h2><span>"+a[s].dateTime+"</span></div>";n.append(t)}else n.append("Sem mensagens")}),e("#load-more").click(function(){var a=n.data("page"),s=e(this);e.getJSON(o,{select:!0,page:a+1},function(e){if(e.success){for(var t=e.data,o=0;o<t.length;o++){var i='<div class="message"><p>'+t[o].message+"</p><h2>"+t[o].name+"</h2><span>"+t[o].dateTime+"</span></div>";n.append(i)}n.data("page",a+1)}else s.attr("disabled","disabled")})})}),e(a).resize(function(){}),e(a).scroll(function(){var s=a.scrollY,t=e(this).scrollTop(),n=15*s/e(a).height();e("#intro .cover").css({"background-position-y":100-n+"%"}),t>c-6*d?(r.addClass("pinned"),h.addClass("show")):(r.removeClass("pinned"),h.removeClass("show")),e(".menu a").each(function(){var a=e(this),s=e("#"+a.data("section"));s.position().top-2*d<=t&&s.position().top+s.height()>t?(e(".menu a").removeClass("active"),a.addClass("active")):a.removeClass("active")})})})}(jQuery,window,document);